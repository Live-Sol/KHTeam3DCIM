<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>회원가입</title>
    <link rel="stylesheet" th:href="@{/css/memberStyle.css}">

</head>
<body>
<div class="container">
    <h2>회원가입</h2>
    <form id="signupForm" th:action="@{/members}" method="POST">
        <div>
            <label for="memberId">아이디</label>
            <input type="text" id="memberId" name="memberId" required>
            <div id="memberIdError" style="color:red; display:none;">아이디는 알파벳 소문자와 숫자만 가능하며, 4~20글자여야 합니다.</div>
        </div>

        <div>
            <label for="password">비밀번호</label>
            <input type="password" id="password" name="password" required>
            <div id="passwordError" style="color:red; display:none;">비밀번호는 4~20글자 사이여야 합니다.</div>
        </div>

        <div>
            <label for="name">이름</label>
            <input type="text" id="name" name="name" required>
            <div id="nameError" style="color:red; display:none;">이름은 한글과 알파벳만 가능하며, 2~10글자여야 합니다.</div>
        </div>

        <!-- role 필드는 기본적으로 USER로 설정되며, 폼에서 선택할 수 없습니다 -->
        <input type="hidden" name="role" value="USER">

        <div>
            <button type="submit">회원가입</button>
        </div>
    </form>
</div>

<script>
    document.getElementById('signupForm').addEventListener('submit', function(event) {
        let valid = true;

        // 아이디 검사
        const memberId = document.getElementById('memberId').value;
        const memberIdPattern = /^[a-z0-9]{4,20}$/; // 알파벳 소문자, 숫자, 4~20글자
        const memberIdError = document.getElementById('memberIdError');
        if (!memberIdPattern.test(memberId)) {
            memberIdError.style.display = 'block';
            document.getElementById('memberId').focus();
            valid = false;
        } else {
            memberIdError.style.display = 'none';
        }

        // 비밀번호 검사
        const password = document.getElementById('password').value;
        const passwordPattern = /^.{4,20}$/; // 4~20글자
        const passwordError = document.getElementById('passwordError');
        if (!passwordPattern.test(password)) {
            passwordError.style.display = 'block';
            document.getElementById('password').focus();
            valid = false;
        } else {
            passwordError.style.display = 'none';
        }

        // 이름 검사
        const name = document.getElementById('name').value;
        const namePattern = /^[a-zA-Z가-힣]{2,10}$/; // 한글, 알파벳, 2~10글자
        const nameError = document.getElementById('nameError');
        if (!namePattern.test(name)) {
            nameError.style.display = 'block';
            document.getElementById('name').focus();
            valid = false;
        } else {
            nameError.style.display = 'none';
        }

        // 유효성 검사를 통과하지 못하면 form 제출을 막음
        if (!valid) {
            event.preventDefault();
        }
    });
</script>
</body>
</html>
